{"ast":null,"code":"// api.js - VERS√ÉO CORRIGIDA\nconst API = '/api';\nexport async function fetchStudents({\n  page = 1,\n  limit = 50,\n  q = ''\n} = {}) {\n  try {\n    const url = new URL(`${API}/students`, window.location.origin);\n    url.searchParams.set('page', page);\n    url.searchParams.set('limit', limit);\n    if (q) url.searchParams.set('q', q);\n    console.log('üîç Buscando:', url.toString());\n    const res = await fetch(url);\n    if (!res.ok) throw new Error(`Erro: ${res.status}`);\n    const data = await res.json();\n    console.log('‚úÖ Dados recebidos:', data);\n    return data;\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n    throw error;\n  }\n}\n\n// üî• FUN√á√ïES PARA HIST√ìRICO\nexport async function getHistoricoAluno(id) {\n  try {\n    const res = await fetch(`${API}/students/${id}/historico`);\n    if (!res.ok) throw new Error(`Erro ${res.status}: ${await res.text()}`);\n    return res.json();\n  } catch (error) {\n    console.error('‚ùå Erro ao buscar hist√≥rico:', error);\n    throw error;\n  }\n}\n\n// No frontend, antes de fazer o POST\nconsole.log('üì§ Dados sendo enviados para o backend:', dadosAluno);\n\n// E verifique a resposta\nfetch('/api/students', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify(dadosAluno)\n}).then(response => {\n  console.log('üì• Resposta do servidor:', response);\n  return response.json();\n}).then(data => {\n  console.log('üìã Dados da resposta:', data);\n}).catch(error => {\n  console.error('‚ùå Erro na requisi√ß√£o:', error);\n});\nexport async function addHistoricoAluno(id, historicoData) {\n  try {\n    const res = await fetch(`${API}/students/${id}/historico`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(historicoData)\n    });\n    if (!res.ok) {\n      const errorText = await res.text();\n      throw new Error(`Erro ${res.status}: ${errorText || 'Erro ao adicionar hist√≥rico'}`);\n    }\n    return res.json();\n  } catch (error) {\n    console.error('‚ùå Erro ao adicionar hist√≥rico:', error);\n    throw error;\n  }\n}\nexport async function deleteHistoricoAluno(id, historicoId) {\n  try {\n    const res = await fetch(`${API}/students/${id}/historico/${historicoId}`, {\n      method: 'DELETE'\n    });\n    if (!res.ok) {\n      const errorText = await res.text();\n      throw new Error(`Erro ${res.status}: ${errorText || 'Erro ao excluir hist√≥rico'}`);\n    }\n    return res.json();\n  } catch (error) {\n    console.error('‚ùå Erro ao excluir hist√≥rico:', error);\n    throw error;\n  }\n}\nexport async function getStudent(id) {\n  try {\n    const res = await fetch(`${API}/students/${id}`);\n    if (!res.ok) throw new Error(`Erro ${res.status}: ${await res.text()}`);\n    return res.json();\n  } catch (error) {\n    console.error('‚ùå Erro ao buscar aluno:', error);\n    throw error;\n  }\n}\n\n// üî• CORRE√á√ÉO: Fun√ß√£o createStudent corrigida\n// Na fun√ß√£o createStudent, atualize o body para incluir os novos campos:\nexport async function createStudent(body) {\n  try {\n    console.log('‚ûï Criando aluno:', body);\n    const res = await fetch(`${API}/students`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        ...body,\n        nomeMae: body.nomeMae || '',\n        nomePai: body.nomePai || '',\n        status: body.status || 'Matriculado'\n      })\n    });\n    // ... resto do c√≥digo\n  } catch (error) {\n    // ... tratamento de erro\n  }\n}\nexport async function updateStudent(id, body) {\n  try {\n    const res = await fetch(`${API}/students/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(body)\n    });\n    if (!res.ok) {\n      const errorText = await res.text();\n      throw new Error(`Erro ${res.status}: ${errorText || 'Erro ao atualizar aluno'}`);\n    }\n    return res.json();\n  } catch (error) {\n    console.error('‚ùå Erro ao atualizar aluno:', error);\n    throw error;\n  }\n}\nexport async function deleteStudent(id) {\n  try {\n    const res = await fetch(`${API}/students/${id}`, {\n      method: 'DELETE'\n    });\n    if (!res.ok) {\n      const errorText = await res.text();\n      throw new Error(`Erro ${res.status}: ${errorText || 'Erro ao excluir aluno'}`);\n    }\n    return res.json();\n  } catch (error) {\n    console.error('‚ùå Erro ao excluir aluno:', error);\n    throw error;\n  }\n}","map":{"version":3,"names":["API","fetchStudents","page","limit","q","url","URL","window","location","origin","searchParams","set","console","log","toString","res","fetch","ok","Error","status","data","json","error","getHistoricoAluno","id","text","dadosAluno","method","headers","body","JSON","stringify","then","response","catch","addHistoricoAluno","historicoData","errorText","deleteHistoricoAluno","historicoId","getStudent","createStudent","nomeMae","nomePai","updateStudent","deleteStudent"],"sources":["D:/Documents/db-nair-cunha/teste-db-matricula-nair-cunha-de-aguiar/frontend/src/api.js"],"sourcesContent":["// api.js - VERS√ÉO CORRIGIDA\r\nconst API = '/api';\r\n\r\nexport async function fetchStudents({ page = 1, limit = 50, q = '' } = {}) {\r\n  try {\r\n    const url = new URL(`${API}/students`, window.location.origin);\r\n    url.searchParams.set('page', page);\r\n    url.searchParams.set('limit', limit);\r\n    if (q) url.searchParams.set('q', q);\r\n    \r\n    console.log('üîç Buscando:', url.toString());\r\n    const res = await fetch(url);\r\n    \r\n    if (!res.ok) throw new Error(`Erro: ${res.status}`);\r\n    \r\n    const data = await res.json();\r\n    console.log('‚úÖ Dados recebidos:', data);\r\n    return data;\r\n  } catch (error) {\r\n    console.error('‚ùå Erro:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// üî• FUN√á√ïES PARA HIST√ìRICO\r\nexport async function getHistoricoAluno(id) {\r\n  try {\r\n    const res = await fetch(`${API}/students/${id}/historico`);\r\n    if (!res.ok) throw new Error(`Erro ${res.status}: ${await res.text()}`);\r\n    return res.json();\r\n  } catch (error) {\r\n    console.error('‚ùå Erro ao buscar hist√≥rico:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// No frontend, antes de fazer o POST\r\nconsole.log('üì§ Dados sendo enviados para o backend:', dadosAluno);\r\n\r\n// E verifique a resposta\r\nfetch('/api/students', {\r\n  method: 'POST',\r\n  headers: { 'Content-Type': 'application/json' },\r\n  body: JSON.stringify(dadosAluno)\r\n})\r\n.then(response => {\r\n  console.log('üì• Resposta do servidor:', response);\r\n  return response.json();\r\n})\r\n.then(data => {\r\n  console.log('üìã Dados da resposta:', data);\r\n})\r\n.catch(error => {\r\n  console.error('‚ùå Erro na requisi√ß√£o:', error);\r\n});\r\nexport async function addHistoricoAluno(id, historicoData) {\r\n  try {\r\n    const res = await fetch(`${API}/students/${id}/historico`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(historicoData)\r\n    });\r\n    \r\n    if (!res.ok) {\r\n      const errorText = await res.text();\r\n      throw new Error(`Erro ${res.status}: ${errorText || 'Erro ao adicionar hist√≥rico'}`);\r\n    }\r\n    \r\n    return res.json();\r\n  } catch (error) {\r\n    console.error('‚ùå Erro ao adicionar hist√≥rico:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function deleteHistoricoAluno(id, historicoId) {\r\n  try {\r\n    const res = await fetch(`${API}/students/${id}/historico/${historicoId}`, {\r\n      method: 'DELETE'\r\n    });\r\n    \r\n    if (!res.ok) {\r\n      const errorText = await res.text();\r\n      throw new Error(`Erro ${res.status}: ${errorText || 'Erro ao excluir hist√≥rico'}`);\r\n    }\r\n    \r\n    return res.json();\r\n  } catch (error) {\r\n    console.error('‚ùå Erro ao excluir hist√≥rico:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getStudent(id) {\r\n  try {\r\n    const res = await fetch(`${API}/students/${id}`);\r\n    if (!res.ok) throw new Error(`Erro ${res.status}: ${await res.text()}`);\r\n    return res.json();\r\n  } catch (error) {\r\n    console.error('‚ùå Erro ao buscar aluno:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// üî• CORRE√á√ÉO: Fun√ß√£o createStudent corrigida\r\n// Na fun√ß√£o createStudent, atualize o body para incluir os novos campos:\r\nexport async function createStudent(body) {\r\n  try {\r\n    console.log('‚ûï Criando aluno:', body);\r\n    \r\n    const res = await fetch(`${API}/students`, { \r\n      method: 'POST', \r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      }, \r\n      body: JSON.stringify({\r\n        ...body,\r\n        nomeMae: body.nomeMae || '',\r\n        nomePai: body.nomePai || '',\r\n        status: body.status || 'Matriculado'\r\n      }) \r\n    });\r\n    // ... resto do c√≥digo\r\n  } catch (error) {\r\n    // ... tratamento de erro\r\n  }\r\n}\r\nexport async function updateStudent(id, body) {\r\n  try {\r\n    const res = await fetch(`${API}/students/${id}`, { \r\n      method: 'PUT', \r\n      headers: {'Content-Type': 'application/json'}, \r\n      body: JSON.stringify(body) \r\n    });\r\n    \r\n    if (!res.ok) {\r\n      const errorText = await res.text();\r\n      throw new Error(`Erro ${res.status}: ${errorText || 'Erro ao atualizar aluno'}`);\r\n    }\r\n    \r\n    return res.json();\r\n  } catch (error) {\r\n    console.error('‚ùå Erro ao atualizar aluno:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function deleteStudent(id) {\r\n  try {\r\n    const res = await fetch(`${API}/students/${id}`, { method: 'DELETE' });\r\n    \r\n    if (!res.ok) {\r\n      const errorText = await res.text();\r\n      throw new Error(`Erro ${res.status}: ${errorText || 'Erro ao excluir aluno'}`);\r\n    }\r\n    \r\n    return res.json();\r\n  } catch (error) {\r\n    console.error('‚ùå Erro ao excluir aluno:', error);\r\n    throw error;\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}